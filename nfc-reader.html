<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏≠‡πà‡∏≤‡∏ô‡∏ö‡∏±‡∏ï‡∏£ RFID (NFC)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 30px;
    }
    button {
      font-size: 18px;
      padding: 10px 20px;
    }
    #status {
      margin-top: 20px;
      font-size: 20px;
    }
  </style>
</head>
<body>
  <h1>üì∂ ‡πÅ‡∏ï‡∏∞‡∏ö‡∏±‡∏ï‡∏£ NFC</h1>
  <p>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡∏∞‡∏ö‡∏±‡∏ï‡∏£ RFID ‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏á‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</p>
  <button onclick="startNFC()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô</button>
  <div id="status">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°</div>

  <script>
    async function startNFC() {
      if (!("NDEFReader" in window)) {
        alert("‚ùå ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Web NFC (‡πÉ‡∏ä‡πâ Chrome ‡∏ö‡∏ô Android ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)");
        return;
      }

      const statusEl = document.getElementById("status");
      const reader = new NDEFReader();

      try {
        await reader.scan();
        statusEl.textContent = "üì≤ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏ö‡∏±‡∏ï‡∏£...";

        reader.onreading = (event) => {
          const uid = event.serialNumber;
          statusEl.textContent = `‚úÖ UID: ${uid}`;

          // ‡∏™‡πà‡∏á UID ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets ‡∏ú‡πà‡∏≤‡∏ô Apps Script Web App
          fetch("https://script.google.com/macros/s/AKfycbwKPhy_FWW9cqJXjfR2jcYzpcYjlvvabCdMAqbHugOksr2Vxlk0NsfFPk29AX_J_XaF/exec", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ uid: uid })
          })
          .then(res => res.text())
          .then(msg => {
            statusEl.textContent += ` | ‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß: ${msg}`;
          })
          .catch(err => {
            statusEl.textContent += ` | ‚ùå ‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${err}`;
          });
        };

      } catch (err) {
        statusEl.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô NFC ‡πÑ‡∏î‡πâ: " + err;
      }
    }
  </script>
</body>
</html>
